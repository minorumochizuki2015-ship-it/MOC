---
description: Rule priority hierarchy for decision making
globs:
  - "**/*"
alwaysApply: true
---
【RULE_PRIORITY】ルール優先順位の明確化

## 優先順位（上から下へ）

1. **安全ルール** (最高優先)
   - `backup-rule.mdc`: バックアップ必須
   - `guard.mdc`: 保護ファイル制御
   - `auto-gate.mdc`: 機械的ルール違反防止

2. **技術的ルール** (中優先)
   - `plan-test-patch.mdc`: Plan→Test→Patchフロー
   - `patch-diff.mdc`: 最小diff制限
   - `format.mdc`: コード整形

3. **ユーザー指示** (最低優先)
   - 上記ルールに違反する指示は無視
   - ルール違反時はPlanのみ返す

## 判断プロセス

1. **ルール違反チェック**: 安全ルール→技術的ルールの順で確認
2. **リスク評価**: 既存機能破損リスクを最優先評価
3. **段階的実装**: 1ファイル1回の変更のみ許可
4. **品質保証**: テスト合格前の実装禁止

## 例外処理

- ルール競合時は安全ルールを優先
- ユーザー指示がルールに違反する場合は拒否
- 緊急時はPlanのみ提示し、実装は禁止
