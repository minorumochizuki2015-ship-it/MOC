---
description: Quality assurance gates and testing requirements
globs:
  - "**/*.py"
  - "**/*.bat"
  - "**/*.ps1"
alwaysApply: true
---
【QUALITY_GATE】品質保証プロセスの強化

## 必須チェックリスト

### 変更前

- [ ] Gitチェックポイント作成 (`checkpoint.mdc`)
- [ ] バックアップ作成 (`backup-rule.mdc`)
- [ ] ルール優先順位確認 (`rule-priority.mdc`)

### 変更中

- [ ] 1ファイル1回の変更のみ (`auto-gate.mdc`)
- [ ] 最小diff制限遵守 (`patch-diff.mdc`)
- [ ] コード整形適用 (`format.mdc`)

### 変更後

- [ ] 差分確認 (変更前後の比較)
- [ ] 実地テスト実行 (動作確認)
- [ ] 既存機能保護確認 (回帰テスト)

## テスト要件

### 必須テスト

1. **単体テスト**: `pytest`実行
2. **型チェック**: `mypy`実行
3. **UIテスト**: `main_modern.py --test-ui`実行
4. **サーバーテスト**: 接続確認

### テスト合格条件

- 全テストがPASS
- エラー・警告なし
- 既存機能の動作確認

## 品質ゲート

### 実装禁止条件

- テスト未実行
- テスト失敗
- ルール違反
- 既存機能破損リスク

### 自動中断条件

- 同一目的で連続2回テスト失敗
- 同一差分の再提案
- ルール違反検出

## ロールバック準備

### 必須準備

- Gitチェックポイント作成
- バックアップ作成
- ロールバック手順の確認

### 失敗時対応

- 即座にロールバック実行
- 問題原因の分析
- 修正計画の再策定
